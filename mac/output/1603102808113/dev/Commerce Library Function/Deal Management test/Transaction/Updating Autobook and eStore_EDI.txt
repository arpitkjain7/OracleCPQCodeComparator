/********************************************************************
Function Name: Updating Autobook and eStore/EDI 
Description: To update the eStore/EDI, Autobook and AutobookFlag.
Author: Arjun Singh
Date: 25-08-2019
********************************************************************/
/********************************************************************
Change log:-
25/08/2019  Arjun Singh         VIPER-448  Updating eStore/EDI to Yes when Customer is SMB
25/08/2019  Arjun Singh  VIPER-452  Updating the eStore/EDI and Autobook based on Deal type and TotalValueUSD($)
25/08/2019  Arjun Singh  VIPER-446  Populating the attribute AutobookFlag for validation on Autobook
17/08/2019       Shruti Sawla    // changes done for Autobook to change <25k to <=25K as part of VIPER-446 
20/21/2019 M Vamsi   VIPER-446 changes done to populate AutoBook attribute 
********************************************************************/

result="";
dlim="~";
dend="|";
sb=stringbuilder();

//variable initialization
totalValueUSD_F=0.0;
totalValueUSD_F=totalValueUSDFloat_t;
poNumber="";
poNumber=purchaseOrderNumber_t;
apttusNo="";
apttusNo=apttus_t;
autobook=false;
//autobook=autoBook_t;
autobookFlag="N";
eDI=eStoreEDI_t;
counter=counter_t;
//Updating AutoBook and eStore/EDI based on Deal Type and Total Value $ (USD) for Jira ID:- Viper-452 by Arjun on 25-Sept-2019
if(dealType_t=="cADRenewal" and (totalValueUSDFloat_t<=25000.00)  and counter==0)
{
 autobook=true;
 //eDI="Yes";
 counter=counter+1;
}

if(dealType_t=="cADRenewal" and (totalValueUSDFloat_t>25000.00) and counter==0)
{
 autobook=false;
 
 //eDI="No";
 counter=counter+1;
}
//end of changes for VIPER-452



if((eStoreEDI_t=="Yes" OR (totalValueUSDFloat_t<=25000.00 and apttus_t=="" and (dealType_t=="cADRenewal" or dealType_t=="cADStandard"))) and (dealType_t=="cADRenewal" or dealType_t=="cADStandard"))
{
autoBook = true;
}

//Adding code to set ediStore value to No for symantecTrial Poc enabled quotes by Rohit/Arjun on 12/24/2019 for SYMINT-3202
//Modified the condition for Deal Type = Trial POC for SYMINT-3131 -Arjun -17-Jan-2020
if(symantecTrialPOC_t==true and dealType_t=="trialPOC")
{
 eDI="No";
}
//end of SYMINT-3202 and SYMINT-3131


//Updating eStore/EDI=Yes for Customer Classification=Commercial for VIPER-448 by Arjun on 25-Sept-2019
if(core_t=="Commercial")
{
 eDI="Yes";
}
//end of changes for VIPER-448


//Updating Autobook Flag for validation on AutoBook for VIPER-446 by Arjun on 25-Sept-2019
// changes done by shruti on 17th aug 2019 on Autobook to change <25k to <=25K as part of VIPER-446 
if(totalValueUSDFloat_t<=25000.00 and apttus_t=="" and (dealType_t=="cADRenewal" or dealType_t=="cADStandard"))
{
 autoBookFlag="Y";
}
if(eStoreEDI_t=="Yes" AND (totalValueUSDFloat_t<=25000.00 and apttus_t=="" and (dealType_t=="cADRenewal" or dealType_t=="cADStandard")))
{
 autoBookFlag="Y";
}

// end of changes for VIPER-446


//Returning the AutobookFlag, Autobook and eStore/EDI for VIPER-448, VIPER-446, VIPER-452 by Arjun on 25-Sep-2019
sbappend(sb,"1~autoBookFlag_t~",autobookFlag,"|","1~autoBook_t~",string(autobook),"|","1~eStoreEDI_t~",eDI,"|","1~counter_t~",string(counter),"|" );

result = sbtostring(sb);
return result;