/***************************************************************************************
Function name : Fetch Quote Info from All Transaction
Author : Nandhini Vurimella.
Description : This is the function returns the quotes and its corresponding Transacrion ID .
History:     Date          Author            Comment 
     07/04/2019    M Vamsi          Fix for BROCAD2-5444, update the logic to pick first 500 quotes after sorting
***************************************************************************************/

retString = json();
retString1 = json();
if(jsonpathcheck(inputJson,"$.items")){
 itemsJsonArray = jsonarray();
 itemsJsonArray = jsonget(inputJson, "items", "jsonarray");
 itemsArraySize = range(jsonarraysize(itemsJsonArray));
 for count in itemsArraySize{
  jsonObj = jsonarrayget(itemsJsonArray, count, "json");
  quoteID = jsonget(jsonObj, "transactionID_t", "string", "");
  bsID = jsonget(jsonObj, "_id", "string", "");
  if(quoteID <> "" and quoteID <> "" and NOT isnull(quoteID)){
  //mapping quote ID to its corrresponding transaction ID. 
   jsonput(retString, quoteID, bsID);
  }
 }
 // changes made for BROCAD2-5444 fix
 keys = jsonkeys(retString);
 sort(keys,"desc");
 for key in keys
 {
  value = jsonget(retString,key);
  jsonput(retString1,key,value);
 }
}

return retString1;