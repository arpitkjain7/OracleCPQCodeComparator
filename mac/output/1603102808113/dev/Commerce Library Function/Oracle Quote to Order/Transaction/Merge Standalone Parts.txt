/************************************************
Rule Name: Merge Quote
Description: This function calls addPartsToTransaction util which would add standalone line items from child quote to parent quote 
Author: M Vamsi Krishna
Creation Date: 22-Feb-2019
History:        
Date            Author            Comment 
29/07/2019      M Vamsi            VIPER - 264 - Pricing Issue in Merge in Renewal Quotes for Subscription lines
08/08/2019 M Vamsi     VIPER - 325 - Pricing Issue in Merge Functionality for large Quotes
10/10/2019      Rohit Ranjan                     Upgrade issue for Oracle 19c- for addpartstotransaction
03/02/2020    M Vamsi     SYMINT-5528 - Support Provider - Systematically Populate on Renewal Quotes
03/26/2020     Arjun     SYMINT-6695 - Replacing tag Supportprovider_l with supportSiteID_l
*/
//Initializing the variable that are being used in the below code
retString = "";
xpaths = string[1];
sb=stringbuilder();

segmentName = "";
productLineName = "";
modelName = "";
modelVarName = "";
modelArray = string[];
partLineDocumnetNo = jsonarray();
finalstring = "";
JsonMergedQuotes = jsonarray();
jsonObjParts = json();
jsonArrayObj = jsonarray();
resultAttributeArray = string[];
flag = "no";
testMerge = "";


if(quotationList_t <> "" and quotationList_t <> " " and NOT isnull(quotationList_t)){
 jsonObj = json(quotationList_t);
 if(mergedQuotes <> "" and mergedQuotes <> " " and NOT isnull(mergedQuotes)){
 mergedQuotesArray = split(mergedQuotes,",");
 
 
  for quoteID in mergedQuotesArray{
  if (len(quoteID) > 1){
  
   bsID = jsonget(jsonObj, quoteID, "string");
   bsIDArray = split(bsID, "%");
   bsID = bsIDArray[0]; 
   //retrieving quote information for the given transactionID.
   result = util.getTransactions(bsID);
   
   if(containskey(result, "ERROR")){
    retString = get(result, "ERROR");
   }elif(containskey(result, "SUCCESS")){
    xmlResponse = get(result, "SUCCESS");
    
    subDocStartPosition = find(xmlResponse, "<bm:sub_documents>");
    subDocEndPosition = find(xmlResponse, "</bm:sub_documents>");
    //retrieving all the line item information from the quote information
    subDocument = substring(xmlResponse, subDocStartPosition+len("<bm:sub_documents>"), subDocEndPosition+len("</bm:sub_documents>"));
    
    
    
    
    
    lineArray = split(subDocument,"</bm:transactionLine>");
    
    
    for each in lineArray
    {
    modelattr=find (each, "<bm:_model_name>");
    modelparentattr=find (each, "<bm:_parent_line_item>");
    //condtion to check whether the given line item is standalone or not.
    if(modelattr==-1 and modelparentattr==-1 and len(each) > 1 )
    {
    jsonObjParts = json();
    flag = "no";
     
     
     //Fetching all the required attributes and their corresponding values which are necessary to pass from child to parent quote.
     //Changes made as part of VIPER - 264 - adding createdBy_l attribute to copy value from child to parent quote to retain the created by user instead of Integration User
     //Changes made as part of VIPER - 325 - adding renewalsImportPricing attribute to copy value from child to parent quote to retain the renewal import pricing value to identify whether the lines are added or updated via import functionality.
     //Changes made as part of VIPER - 5528 - adding supportSiteID_l attribute to copy value from child to parent quote
     //Replacing tag Supportprovider_l with supportSiteID_l for SYMINT-6695 by Arjun 26-Mar-20
     ColonSeparatedTags = "_part_number:_price_quantity:productName_l:licenseType_l:contractStartDate_l:contractEndDate_l:transactionTypeM_l:businessTransactionType_l:specialMetric_l:enterEnvironment_l:licenseType_l:supportType_l:languageRequired_l:standardQuantity_l:existingQuantity_l:nonStandardLicenseMetric_l:licenseMetric_l:specialMetricLicense_l:usageQuantity_l:usageExistingQuantity_l:productType_l:salesMin1_l:salesMin2_l:salesMin3_l:mPNStatus_l:bundlePartNumber_l:fulfillmentSet_l:countryOfOrigin_l:renewalsAllowed_l:cPN_l:cPNRequired_l:coveredProduct_l:description_l:extContractListPrice_l:requiresSupport_l:supportOptOut_l:requestedNetUnitPrice_l:lineDiscountAmount_l:extLineDiscountAmount_l:approverRecommendedNetUnitPrice_l:approverRecommendedExtNetPrice_l:effectiveStartDate_l:lineExpirationDate_l:unitCost_l:extCost_l:unitMSRP_l:pL_l:sPI_l:sRT_l:cPProductFamily_l:dropProduct_l:dropReason_l:dropSupportDate_l:stabilizationDate_l:businessType_l:nonStandardQty_l:licenseMetric_l:nonStandardLicenseMetric_l:quoteLineStatus_l:totalPrice_l:existingContractValue_l:endOfSupportServiceDate_l:targetPrice_l:previewWorkflowBinoculars_l:externalComments_l:totalValue_l:specialMetricLicense_l:specialMetric_l:usageQuantity_l:nonStandardExistingQty_l:serviceRequired_l:uSDCurrency_l:contractedOrPriorDealValue_l:contractedOrPriorLicenseSubFee_l:contractedOrPriorSupportFee_l:priceUpliftAnnualRenewalValue_l:newAnnualRenewalValue_l:renewalRate_l:upgradeMaterial_l:rollToLine_l:existingContractQty_l:existingQuantity_l:existingContractValue_l:approvalFlag_l:uplift_l:active_l:OfDaysInTerm_l:serial_l:cPUModelSerial_l:mmsCompletionFlag_l:daysBeforeQuarterEnd_l:unlimited_l:monthlyFeePerUnitUSD_l:baseProduct_l:flags_l:priorContractLineItem_l:priorContractExpirationDate_l:priorContract:taxInvoiceComment_l:isDiscountable_l:standardQuantity_l:estAnnualizedBooking_l:estQuarterlyRevenue_l:deviation_l:deviationPercent_l:capacityAllowed_l:newSalesAllowed_l:perUnitPerListPrice_l:totalNewSupportTermDays_l:existingSupportStartDateString_l:existingSupportExpirationDateString_l:previousPrice_l:installedAtCustomerNumber_l:siteID_l:siteIDStreetAddress_l:siteIDCityStateZip_l:siteIDZip_l:siteIDCountry_l:hiddenPrice_l:projectEstStartDate_l:projectEstEndDate_l:serviceOffering_l:costCenter_l:chargeCode_l:expenseAmountIncluded_l:changeHoursunits_l:businessUnit_l:totalChangeAmount_l:projectDescription_l:projectGroup_l:approver_l:eOSDate_l:existingSupportStartDate_l:existingSupportExpirationDate_l:monthlyFeePerUnitUSD_l:expiringAnnualRenewal_l:marginPercent_l:requestedDiscount_l:createdBy_l:renewalsImportPricing:renewalCreatedBy_l:itemInstanceId_l:supportSiteID_l";
     ColonSeparatedFields = "partNumber:quantity:productName_l:licenseType_l:contractStartDate_l:contractEndDate_l:transactionTypeM_l:businessTransactionType_l:specialMetric_l:enterEnvironment_l:licenseType_l:supportType_l:languageRequired_l:standardQuantity_l:existingQuantity_l:nonStandardLicenseMetric_l:licenseMetric_l:specialMetricLicense_l:usageQuantity_l:usageExistingQuantity_l:productType_l:salesMin1_l:salesMin2_l:salesMin3_l:mPNStatus_l:bundlePartNumber_l:fulfillmentSet_l:countryOfOrigin_l:renewalsAllowed_l:cPN_l:cPNRequired_l:coveredProduct_l:description_l:extContractListPrice_l:requiresSupport_l:supportOptOut_l:requestedNetUnitPrice_l:lineDiscountAmount_l:extLineDiscountAmount_l:approverRecommendedNetUnitPrice_l:approverRecommendedExtNetPrice_l:effectiveStartDate_l:lineExpirationDate_l:unitCost_l:extCost_l:unitMSRP_l:pL_l:sPI_l:sRT_l:cPProductFamily_l:dropProduct_l:dropReason_l:dropSupportDate_l:stabilizationDate_l:businessType_l:nonStandardQty_l:licenseMetric_l:nonStandardLicenseMetric_l:quoteLineStatus_l:totalPrice_l:existingContractValue_l:endOfSupportServiceDate_l:targetPrice_l:previewWorkflowBinoculars_l:externalComments_l:totalValue_l:specialMetricLicense_l:specialMetric_l:usageQuantity_l:nonStandardExistingQty_l:serviceRequired_l:uSDCurrency_l:contractedOrPriorDealValue_l:contractedOrPriorLicenseSubFee_l:contractedOrPriorSupportFee_l:priceUpliftAnnualRenewalValue_l:newAnnualRenewalValue_l:renewalRate_l:upgradeMaterial_l:rollToLine_l:existingContractQty_l:existingQuantity_l:existingContractValue_l:approvalFlag_l:uplift_l:active_l:OfDaysInTerm_l:serial_l:cPUModelSerial_l:mmsCompletionFlag_l:daysBeforeQuarterEnd_l:unlimited_l:monthlyFeePerUnitUSD_l:baseProduct_l:flags_l:priorContractLineItem_l:priorContractExpirationDate_l:priorContract:taxInvoiceComment_l:isDiscountable_l:standardQuantity_l:estAnnualizedBooking_l:estQuarterlyRevenue_l:deviation_l:deviationPercent_l:capacityAllowed_l:newSalesAllowed_l:perUnitPerListPrice_l:totalNewSupportTermDays_l:existingSupportStartDateString_l:existingSupportExpirationDateString_l:previousPrice_l:installedAtCustomerNumber_l:siteID_l:siteIDStreetAddress_l:siteIDCityStateZip_l:siteIDZip_l:siteIDCountry_l:hiddenPrice_l:projectEstStartDate_l:projectEstEndDate_l:serviceOffering_l:costCenter_l:chargeCode_l:expenseAmountIncluded_l:changeHoursunits_l:businessUnit_l:totalChangeAmount_l:projectDescription_l:projectGroup_l:approver_l:eOSDate_l:existingSupportStartDate_l:existingSupportExpirationDate_l:monthlyFeePerUnitUSD_l:expiringAnnualRenewal_l:marginPercent_l:requestedDiscount_l:createdBy_l:renewalsImportPricing:renewalCreatedBy_l:itemInstanceId_l:supportSiteID_l"; 
     Tags = split(ColonSeparatedTags,":");
     Fields = split(ColonSeparatedFields,":");
     
     i = 0;
     For Tag in Tags 
      {
      OpenTag = "<bm:" + Tag + ">";
      CloseTag = "</bm:" + Tag + ">";
      
      j=0;
      for Field in Fields  
       {
       
       if (i == j)
        {
        
        if(find(each, OpenTag) > 1)
         {
         partnumStartPosition = find(each, OpenTag);
         partnumEndPosition = find(each, CloseTag);
         value = "";
         value= substring(each, partnumStartPosition+len(OpenTag), partnumEndPosition);
         //identifying all the currency attributes for which the we need to fetch the currency value. 
         if(Field == "unitMSRP_l" or Field == "expiringAnnualRenewal_l" or Field == "previousPrice_l" or Field == "salesMin1_l" or Field == "salesMin2_l" or Field == "salesMin3_l" or Field == "perUnitPerListPrice_l" or Field == "proposedNetUnitPriceRequested_l" or Field == "extProposedNetPriceRequested_l" or Field == "requestedNetUnitPrice_l" or Field == "lineDiscountAmount_l" or Field == "extLineDiscountAmount_l" or Field == "approverRecommendedNetUnitPrice_l" or Field == "approverRecommendedExtNetPrice_l" or Field == "unitCost_l" or Field == "extCost_l" or Field == "newAnnualRenewalValue_l" or Field == "estAnnualizedBooking_l" or Field ==  "estQuarterlyRevenue_l" or Field == "extContractListPrice_l" or Field == "monthlyFeePerUnitUSD_l" or Field == "totalPrice_l")
         {
         value= substring(each, partnumStartPosition+len(OpenTag), partnumEndPosition);
         value = string(getcurrencyvalue(value,currency_t));
         
         }
         jsonput(jsonObjParts,Field,value);
         flag = "yes";
         
         }
        }
       j=j+1;
       
       
       }
      
      i=i+1;
      
     }
     
     
     
     jsonkeysarr = jsonKeys(jsonObjParts);
     keyArraySize = sizeofarray(jsonkeysarr);
     if (keyArraySize > 1)
     {
     jsonarrayappend(jsonArrayObj,jsonObjParts);
     }
    
    }
    }
    

   }
   
  //}
  }
  jsonObjParts = json();
 }
    //triggering add parts to transaction UTIL
    response = addpartstotransaction(jsonArrayObj,"_default_price_book", resultAttributeArray);
size=jsonarraysize(response);
range1=range(size);
dropReasonVal="";
for each in range1{
jsonResponse=jsonarrayget(response,each,"json");
jsonData=jsonarrayget(jsonArrayObj,each,"json");
docNUm=jsonpathgetsingle(jsonResponse,"$._document_number");

productName_l=jsonpathgetsingle(jsonData,"$.productName_l");
if(productName_l<>"" AND NOT isnull(productName_l) AND productName_l<>" ")
{
sbappend(sb,docNum,"~productName_l~",productName_l,"|");
}
else
{
sbappend(sb,docNum,"~productName_l~","","|");
}
licenseType_l=jsonpathgetsingle(jsonData,"$.licenseType_l");
if(licenseType_l<>"" AND NOT isnull(licenseType_l) AND licenseType_l<>" ")
{
sbappend(sb,docNum,"~licenseType_l~",licenseType_l,"|");
}
else
{
sbappend(sb,docNum,"~licenseType_l~","","|");
}
contractStartDate_l=jsonpathgetsingle(jsonData,"$.contractStartDate_l");
if(contractStartDate_l<>"" AND NOT isnull(contractStartDate_l) AND contractStartDate_l<>" ")
{
sbappend(sb,docNum,"~contractStartDate_l~",contractStartDate_l,"|");
}
else
{
sbappend(sb,docNum,"~contractStartDate_l~",contractStartDate_t,"|");
}
contractEndDate_l=jsonpathgetsingle(jsonData,"$.contractEndDate_l");
if(contractEndDate_l<>"" AND NOT isnull(contractEndDate_l) AND contractEndDate_l<>" ")
{
sbappend(sb,docNum,"~contractEndDate_l~",contractEndDate_l,"|");
}
else
{
sbappend(sb,docNum,"~contractEndDate_l~",contractEndDate_t,"|");
}
transactionTypeM_l=jsonpathgetsingle(jsonData,"$.transactionTypeM_l");
if(transactionTypeM_l<>"" AND NOT isnull(transactionTypeM_l) AND transactionTypeM_l<>" ")
{
sbappend(sb,docNum,"~transactionTypeM_l~",transactionTypeM_l,"|");
}
else
{
sbappend(sb,docNum,"~transactionTypeM_l~","","|");
}
businessTransactionType_l=jsonpathgetsingle(jsonData,"$.businessTransactionType_l");
if(businessTransactionType_l<>"" AND NOT isnull(businessTransactionType_l) AND businessTransactionType_l<>" ")
{
sbappend(sb,docNum,"~businessTransactionType_l~",businessTransactionType_l,"|");
}
else
{
sbappend(sb,docNum,"~businessTransactionType_l~","","|");
}
specialMetric_l=jsonpathgetsingle(jsonData,"$.specialMetric_l");
if(specialMetric_l<>"" AND NOT isnull(specialMetric_l) AND specialMetric_l<>" ")
{
sbappend(sb,docNum,"~specialMetric_l~",specialMetric_l,"|");
}
else
{
sbappend(sb,docNum,"~specialMetric_l~","","|");
}
enterEnvironment_l=jsonpathgetsingle(jsonData,"$.enterEnvironment_l");
if(enterEnvironment_l<>"" AND NOT isnull(enterEnvironment_l) AND enterEnvironment_l<>" ")
{
sbappend(sb,docNum,"~enterEnvironment_l~",enterEnvironment_l,"|");
}
else
{
sbappend(sb,docNum,"~enterEnvironment_l~","","|");
}
licenseType_l=jsonpathgetsingle(jsonData,"$.licenseType_l");
if(licenseType_l<>"" AND NOT isnull(licenseType_l) AND licenseType_l<>" ")
{
sbappend(sb,docNum,"~licenseType_l~",licenseType_l,"|");
}
else
{
sbappend(sb,docNum,"~licenseType_l~","","|");
}
supportType_l=jsonpathgetsingle(jsonData,"$.supportType_l");
if(supportType_l<>"" AND NOT isnull(supportType_l) AND supportType_l<>" ")
{
sbappend(sb,docNum,"~supportType_l~",supportType_l,"|");
}
else
{
sbappend(sb,docNum,"~supportType_l~","","|");
}
languageRequired_l=jsonpathgetsingle(jsonData,"$.languageRequired_l");
if(languageRequired_l<>"" AND NOT isnull(languageRequired_l) AND languageRequired_l<>" ")
{
sbappend(sb,docNum,"~languageRequired_l~",languageRequired_l,"|");
}
else
{
sbappend(sb,docNum,"~languageRequired_l~","","|");
}
standardQuantity_l=jsonpathgetsingle(jsonData,"$.standardQuantity_l");
if(standardQuantity_l<>"" AND NOT isnull(standardQuantity_l) AND standardQuantity_l<>" ")
{
sbappend(sb,docNum,"~standardQuantity_l~",standardQuantity_l,"|");
}
else
{
sbappend(sb,docNum,"~standardQuantity_l~","0","|");
}
existingQuantity_l=jsonpathgetsingle(jsonData,"$.existingQuantity_l");
if(existingQuantity_l<>"" AND NOT isnull(existingQuantity_l) AND existingQuantity_l<>" ")
{
sbappend(sb,docNum,"~existingQuantity_l~",existingQuantity_l,"|");
}
else
{
sbappend(sb,docNum,"~existingQuantity_l~","0","|");
}
nonStandardLicenseMetric_l=jsonpathgetsingle(jsonData,"$.nonStandardLicenseMetric_l");
if(nonStandardLicenseMetric_l<>"" AND NOT isnull(nonStandardLicenseMetric_l) AND nonStandardLicenseMetric_l<>" ")
{
sbappend(sb,docNum,"~nonStandardLicenseMetric_l~",nonStandardLicenseMetric_l,"|");
}
else
{
sbappend(sb,docNum,"~nonStandardLicenseMetric_l~","","|");
}
licenseMetric_l=jsonpathgetsingle(jsonData,"$.licenseMetric_l");
if(licenseMetric_l<>"" AND NOT isnull(licenseMetric_l) AND licenseMetric_l<>" ")
{
sbappend(sb,docNum,"~licenseMetric_l~",licenseMetric_l,"|");
}
else
{
sbappend(sb,docNum,"~licenseMetric_l~","","|");
}
specialMetricLicense_l=jsonpathgetsingle(jsonData,"$.specialMetricLicense_l");
if(specialMetricLicense_l<>"" AND NOT isnull(specialMetricLicense_l) AND specialMetricLicense_l<>" ")
{
sbappend(sb,docNum,"~specialMetricLicense_l~",specialMetricLicense_l,"|");
}
else
{
sbappend(sb,docNum,"~specialMetricLicense_l~","","|");
}
usageQuantity_l=jsonpathgetsingle(jsonData,"$.usageQuantity_l");
if(usageQuantity_l<>"" AND NOT isnull(usageQuantity_l) AND usageQuantity_l<>" ")
{
sbappend(sb,docNum,"~usageQuantity_l~",usageQuantity_l,"|");
}
else
{
sbappend(sb,docNum,"~usageQuantity_l~","0","|");
}
usageExistingQuantity_l=jsonpathgetsingle(jsonData,"$.usageExistingQuantity_l");
if(usageExistingQuantity_l<>"" AND NOT isnull(usageExistingQuantity_l) AND usageExistingQuantity_l<>" ")
{
sbappend(sb,docNum,"~usageExistingQuantity_l~",usageExistingQuantity_l,"|");
}
else
{
sbappend(sb,docNum,"~usageExistingQuantity_l~","0","|");
}
productType_l=jsonpathgetsingle(jsonData,"$.productType_l");
if(productType_l<>"" AND NOT isnull(productType_l) AND productType_l<>" ")
{
sbappend(sb,docNum,"~productType_l~",productType_l,"|");
}
else
{
sbappend(sb,docNum,"~productType_l~","","|");
}
salesMin1_l=jsonpathgetsingle(jsonData,"$.salesMin1_l");
if(salesMin1_l<>"" AND NOT isnull(salesMin1_l) AND salesMin1_l<>" ")
{
sbappend(sb,docNum,"~salesMin1_l~",salesMin1_l,"|");
}
else
{
sbappend(sb,docNum,"~salesMin1_l~","0","|");
}
salesMin2_l=jsonpathgetsingle(jsonData,"$.salesMin2_l");
if(salesMin2_l<>"" AND NOT isnull(salesMin2_l) AND salesMin2_l<>" ")
{
sbappend(sb,docNum,"~salesMin2_l~",salesMin2_l,"|");
}
else
{
sbappend(sb,docNum,"~salesMin2_l~","0","|");
}
salesMin3_l=jsonpathgetsingle(jsonData,"$.salesMin3_l");
if(salesMin3_l<>"" AND NOT isnull(salesMin3_l) AND salesMin3_l<>" ")
{
sbappend(sb,docNum,"~salesMin3_l~",salesMin3_l,"|");
}
else
{
sbappend(sb,docNum,"~salesMin3_l~","0","|");
}
mPNStatus_l=jsonpathgetsingle(jsonData,"$.mPNStatus_l");
if(mPNStatus_l<>"" AND NOT isnull(mPNStatus_l) AND mPNStatus_l<>" ")
{
sbappend(sb,docNum,"~mPNStatus_l~",mPNStatus_l,"|");
}
else
{
sbappend(sb,docNum,"~mPNStatus_l~","","|");
}
bundlePartNumber_l=jsonpathgetsingle(jsonData,"$.bundlePartNumber_l");
if(bundlePartNumber_l<>"" AND NOT isnull(bundlePartNumber_l) AND bundlePartNumber_l<>" ")
{
sbappend(sb,docNum,"~bundlePartNumber_l~",bundlePartNumber_l,"|");
}
else
{
sbappend(sb,docNum,"~bundlePartNumber_l~","","|");
}
fulfillmentSet_l=jsonpathgetsingle(jsonData,"$.fulfillmentSet_l");
if(fulfillmentSet_l<>"" AND NOT isnull(fulfillmentSet_l) AND fulfillmentSet_l<>" ")
{
sbappend(sb,docNum,"~fulfillmentSet_l~",fulfillmentSet_l,"|");
}
else
{
sbappend(sb,docNum,"~fulfillmentSet_l~","","|");
}
countryOfOrigin_l=jsonpathgetsingle(jsonData,"$.countryOfOrigin_l");
if(countryOfOrigin_l<>"" AND NOT isnull(countryOfOrigin_l) AND countryOfOrigin_l<>" ")
{
sbappend(sb,docNum,"~countryOfOrigin_l~",countryOfOrigin_l,"|");
}
else
{
sbappend(sb,docNum,"~countryOfOrigin_l~","","|");
}
renewalsAllowed_l=jsonpathgetsingle(jsonData,"$.renewalsAllowed_l");
if(renewalsAllowed_l<>"" AND NOT isnull(renewalsAllowed_l) AND renewalsAllowed_l<>" ")
{
sbappend(sb,docNum,"~renewalsAllowed_l~",renewalsAllowed_l,"|");
}
else
{
sbappend(sb,docNum,"~renewalsAllowed_l~","","|");
}
cPN_l=jsonpathgetsingle(jsonData,"$.cPN_l");
if(cPN_l<>"" AND NOT isnull(cPN_l) AND cPN_l<>" ")
{
sbappend(sb,docNum,"~cPN_l~",cPN_l,"|");
}
else
{
sbappend(sb,docNum,"~cPN_l~","","|");
}
cPNRequired_l=jsonpathgetsingle(jsonData,"$.cPNRequired_l");
if(cPNRequired_l<>"" AND NOT isnull(cPNRequired_l) AND cPNRequired_l<>" ")
{
sbappend(sb,docNum,"~cPNRequired_l~",cPNRequired_l,"|");
}
else
{
sbappend(sb,docNum,"~cPNRequired_l~","","|");
}
coveredProduct_l=jsonpathgetsingle(jsonData,"$.coveredProduct_l");
if(coveredProduct_l<>"" AND NOT isnull(coveredProduct_l) AND coveredProduct_l<>" ")
{
sbappend(sb,docNum,"~coveredProduct_l~",coveredProduct_l,"|");
}
else
{
sbappend(sb,docNum,"~coveredProduct_l~","","|");
}
description_l=jsonpathgetsingle(jsonData,"$.description_l");
if(description_l<>"" AND NOT isnull(description_l) AND description_l<>" ")
{
sbappend(sb,docNum,"~description_l~",description_l,"|");
}
else
{
sbappend(sb,docNum,"~description_l~","","|");
}
extContractListPrice_l=jsonpathgetsingle(jsonData,"$.extContractListPrice_l");
if(extContractListPrice_l<>"" AND NOT isnull(extContractListPrice_l) AND extContractListPrice_l<>" ")
{
sbappend(sb,docNum,"~extContractListPrice_l~",extContractListPrice_l,"|");
}
else
{
sbappend(sb,docNum,"~extContractListPrice_l~","0","|");
}
requiresSupport_l=jsonpathgetsingle(jsonData,"$.requiresSupport_l");
if(requiresSupport_l<>"" AND NOT isnull(requiresSupport_l) AND requiresSupport_l<>" ")
{
sbappend(sb,docNum,"~requiresSupport_l~",requiresSupport_l,"|");
}
else
{
sbappend(sb,docNum,"~requiresSupport_l~","","|");
}
supportOptOut_l=jsonpathgetsingle(jsonData,"$.supportOptOut_l");
if(supportOptOut_l<>"" AND NOT isnull(supportOptOut_l) AND supportOptOut_l<>" ")
{
sbappend(sb,docNum,"~supportOptOut_l~",supportOptOut_l,"|");
}
else
{
sbappend(sb,docNum,"~supportOptOut_l~","","|");
}
requestedNetUnitPrice_l=jsonpathgetsingle(jsonData,"$.requestedNetUnitPrice_l");
if(requestedNetUnitPrice_l<>"" AND NOT isnull(requestedNetUnitPrice_l) AND requestedNetUnitPrice_l<>" ")
{
sbappend(sb,docNum,"~requestedNetUnitPrice_l~",requestedNetUnitPrice_l,"|");
}
else
{
sbappend(sb,docNum,"~requestedNetUnitPrice_l~","0","|");
}
lineDiscountAmount_l=jsonpathgetsingle(jsonData,"$.lineDiscountAmount_l");
if(lineDiscountAmount_l<>"" AND NOT isnull(lineDiscountAmount_l) AND lineDiscountAmount_l<>" ")
{
sbappend(sb,docNum,"~lineDiscountAmount_l~",lineDiscountAmount_l,"|");
}
else
{
sbappend(sb,docNum,"~lineDiscountAmount_l~","0","|");
}
extLineDiscountAmount_l=jsonpathgetsingle(jsonData,"$.extLineDiscountAmount_l");
if(extLineDiscountAmount_l<>"" AND NOT isnull(extLineDiscountAmount_l) AND extLineDiscountAmount_l<>" ")
{
sbappend(sb,docNum,"~extLineDiscountAmount_l~",extLineDiscountAmount_l,"|");
}
else
{
sbappend(sb,docNum,"~extLineDiscountAmount_l~","0","|");
}
approverRecommendedNetUnitPrice_l=jsonpathgetsingle(jsonData,"$.approverRecommendedNetUnitPrice_l");
if(approverRecommendedNetUnitPrice_l<>"" AND NOT isnull(approverRecommendedNetUnitPrice_l) AND approverRecommendedNetUnitPrice_l<>" ")
{
sbappend(sb,docNum,"~approverRecommendedNetUnitPrice_l~",approverRecommendedNetUnitPrice_l,"|");
}
else
{
sbappend(sb,docNum,"~approverRecommendedNetUnitPrice_l~","0","|");
}
approverRecommendedExtNetPrice_l=jsonpathgetsingle(jsonData,"$.approverRecommendedExtNetPrice_l");
if(approverRecommendedExtNetPrice_l<>"" AND NOT isnull(approverRecommendedExtNetPrice_l) AND approverRecommendedExtNetPrice_l<>" ")
{
sbappend(sb,docNum,"~approverRecommendedExtNetPrice_l~",approverRecommendedExtNetPrice_l,"|");
}
else
{
sbappend(sb,docNum,"~approverRecommendedExtNetPrice_l~","0","|");
}
effectiveStartDate_l=jsonpathgetsingle(jsonData,"$.effectiveStartDate_l");
if(effectiveStartDate_l<>"" AND NOT isnull(effectiveStartDate_l) AND effectiveStartDate_l<>" ")
{
sbappend(sb,docNum,"~effectiveStartDate_l~",effectiveStartDate_l,"|");
}
else
{
sbappend(sb,docNum,"~effectiveStartDate_l~",quoteEffectiveDate_t,"|");
}
lineExpirationDate_l=jsonpathgetsingle(jsonData,"$.lineExpirationDate_l");
if(lineExpirationDate_l<>"" AND NOT isnull(lineExpirationDate_l) AND lineExpirationDate_l<>" ")
{
sbappend(sb,docNum,"~lineExpirationDate_l~",lineExpirationDate_l,"|");
}
else
{
sbappend(sb,docNum,"~lineExpirationDate_l~",quoteExpirationDate_t,"|");
}
unitCost_l=jsonpathgetsingle(jsonData,"$.unitCost_l");
if(unitCost_l<>"" AND NOT isnull(unitCost_l) AND unitCost_l<>" ")
{
sbappend(sb,docNum,"~unitCost_l~",unitCost_l,"|");
}
else
{
sbappend(sb,docNum,"~unitCost_l~","","|");
}
extCost_l=jsonpathgetsingle(jsonData,"$.extCost_l");
if(extCost_l<>"" AND NOT isnull(extCost_l) AND extCost_l<>" ")
{
sbappend(sb,docNum,"~extCost_l~",extCost_l,"|");
}
else
{
sbappend(sb,docNum,"~extCost_l~","0","|");
}
unitMSRP_l=jsonpathgetsingle(jsonData,"$.unitMSRP_l");
if(unitMSRP_l<>"" AND NOT isnull(unitMSRP_l) AND unitMSRP_l<>" ")
{
sbappend(sb,docNum,"~unitMSRP_l~",unitMSRP_l,"|");
}
else
{
sbappend(sb,docNum,"~unitMSRP_l~","0","|");
}
pL_l=jsonpathgetsingle(jsonData,"$.pL_l");
if(pL_l<>"" AND NOT isnull(pL_l) AND pL_l<>" ")
{
sbappend(sb,docNum,"~pL_l~",pL_l,"|");
}
else
{
sbappend(sb,docNum,"~pL_l~","","|");
}
sPI_l=jsonpathgetsingle(jsonData,"$.sPI_l");
if(sPI_l<>"" AND NOT isnull(sPI_l) AND sPI_l<>" ")
{
sbappend(sb,docNum,"~sPI_l~",sPI_l,"|");
}
else
{
sbappend(sb,docNum,"~sPI_l~","","|");
}
sRT_l=jsonpathgetsingle(jsonData,"$.sRT_l");
if(sRT_l<>"" AND NOT isnull(sRT_l) AND sRT_l<>" ")
{
sbappend(sb,docNum,"~sRT_l~",sRT_l,"|");
}
else
{
sbappend(sb,docNum,"~sRT_l~","","|");
}
cPProductFamily_l=jsonpathgetsingle(jsonData,"$.cPProductFamily_l");
if(cPProductFamily_l<>"" AND NOT isnull(cPProductFamily_l) AND cPProductFamily_l<>" ")
{
sbappend(sb,docNum,"~cPProductFamily_l~",cPProductFamily_l,"|");
}
else
{
sbappend(sb,docNum,"~cPProductFamily_l~","","|");
}
dropSupportDate_l=jsonpathgetsingle(jsonData,"$.dropSupportDate_l");
if(dropSupportDate_l<>"" AND NOT isnull(dropSupportDate_l) AND dropSupportDate_l<>" ")
{
sbappend(sb,docNum,"~dropSupportDate_l~",dropSupportDate_l,"|");
}
else
{
sbappend(sb,docNum,"~dropSupportDate_l~",BRCM_blankDate_t,"|");
}
stabilizationDate_l=jsonpathgetsingle(jsonData,"$.stabilizationDate_l");
if(stabilizationDate_l<>"" AND NOT isnull(stabilizationDate_l) AND stabilizationDate_l<>" ")
{
sbappend(sb,docNum,"~stabilizationDate_l~",stabilizationDate_l,"|");
}
else
{
sbappend(sb,docNum,"~stabilizationDate_l~",BRCM_blankDate_t,"|");
}
businessType_l=jsonpathgetsingle(jsonData,"$.businessType_l");
if(businessType_l<>"" AND NOT isnull(businessType_l) AND businessType_l<>" ")
{
sbappend(sb,docNum,"~businessType_l~",businessType_l,"|");
}
else
{
sbappend(sb,docNum,"~businessType_l~","","|");
}
nonStandardQty_l=jsonpathgetsingle(jsonData,"$.nonStandardQty_l");
if(nonStandardQty_l<>"" AND NOT isnull(nonStandardQty_l) AND nonStandardQty_l<>" ")
{
sbappend(sb,docNum,"~nonStandardQty_l~",nonStandardQty_l,"|");
}
else
{
sbappend(sb,docNum,"~nonStandardQty_l~","0","|");
}
licenseMetric_l=jsonpathgetsingle(jsonData,"$.licenseMetric_l");
if(licenseMetric_l<>"" AND NOT isnull(licenseMetric_l) AND licenseMetric_l<>" ")
{
sbappend(sb,docNum,"~licenseMetric_l~",licenseMetric_l,"|");
}
else
{
sbappend(sb,docNum,"~licenseMetric_l~","","|");
}
nonStandardLicenseMetric_l=jsonpathgetsingle(jsonData,"$.nonStandardLicenseMetric_l");
if(nonStandardLicenseMetric_l<>"" AND NOT isnull(nonStandardLicenseMetric_l) AND nonStandardLicenseMetric_l<>" ")
{
sbappend(sb,docNum,"~nonStandardLicenseMetric_l~",nonStandardLicenseMetric_l,"|");
}
else
{
sbappend(sb,docNum,"~nonStandardLicenseMetric_l~","","|");
}
quoteLineStatus_l=jsonpathgetsingle(jsonData,"$.quoteLineStatus_l");
if(quoteLineStatus_l<>"" AND NOT isnull(quoteLineStatus_l) AND quoteLineStatus_l<>" ")
{
sbappend(sb,docNum,"~quoteLineStatus_l~",quoteLineStatus_l,"|");
}
else
{
sbappend(sb,docNum,"~quoteLineStatus_l~","","|");
}
totalPrice_l=jsonpathgetsingle(jsonData,"$.totalPrice_l");
if(totalPrice_l<>"" AND NOT isnull(totalPrice_l) AND totalPrice_l<>" ")
{
sbappend(sb,docNum,"~totalPrice_l~",totalPrice_l,"|");
}
else
{
sbappend(sb,docNum,"~totalPrice_l~","0","|");
}
existingContractValue_l=jsonpathgetsingle(jsonData,"$.existingContractValue_l");
if(existingContractValue_l<>"" AND NOT isnull(existingContractValue_l) AND existingContractValue_l<>" ")
{
sbappend(sb,docNum,"~existingContractValue_l~",existingContractValue_l,"|");
}
else
{
sbappend(sb,docNum,"~existingContractValue_l~","0","|");
}
endOfSupportServiceDate_l=jsonpathgetsingle(jsonData,"$.endOfSupportServiceDate_l");
if(endOfSupportServiceDate_l<>"" AND NOT isnull(endOfSupportServiceDate_l) AND endOfSupportServiceDate_l<>" ")
{
sbappend(sb,docNum,"~endOfSupportServiceDate_l~",endOfSupportServiceDate_l,"|");
}
else
{
sbappend(sb,docNum,"~endOfSupportServiceDate_l~","","|");
}
targetPrice_l=jsonpathgetsingle(jsonData,"$.targetPrice_l");
if(targetPrice_l<>"" AND NOT isnull(targetPrice_l) AND targetPrice_l<>" ")
{
sbappend(sb,docNum,"~targetPrice_l~",targetPrice_l,"|");
}
else
{
sbappend(sb,docNum,"~targetPrice_l~","0","|");
}
previewWorkflowBinoculars_l=jsonpathgetsingle(jsonData,"$.previewWorkflowBinoculars_l");
if(previewWorkflowBinoculars_l<>"" AND NOT isnull(previewWorkflowBinoculars_l) AND previewWorkflowBinoculars_l<>" ")
{
sbappend(sb,docNum,"~previewWorkflowBinoculars_l~",previewWorkflowBinoculars_l,"|");
}
else
{
sbappend(sb,docNum,"~previewWorkflowBinoculars_l~","","|");
}
externalComments_l=jsonpathgetsingle(jsonData,"$.externalComments_l");
if(externalComments_l<>"" AND NOT isnull(externalComments_l) AND externalComments_l<>" ")
{
sbappend(sb,docNum,"~externalComments_l~",externalComments_l,"|");
}
else
{
sbappend(sb,docNum,"~externalComments_l~","","|");
}
totalValue_l=jsonpathgetsingle(jsonData,"$.totalValue_l");
if(totalValue_l<>"" AND NOT isnull(totalValue_l) AND totalValue_l<>" ")
{
sbappend(sb,docNum,"~totalValue_l~",totalValue_l,"|");
}
else
{
sbappend(sb,docNum,"~totalValue_l~","0","|");
}
specialMetricLicense_l=jsonpathgetsingle(jsonData,"$.specialMetricLicense_l");
if(specialMetricLicense_l<>"" AND NOT isnull(specialMetricLicense_l) AND specialMetricLicense_l<>" ")
{
sbappend(sb,docNum,"~specialMetricLicense_l~",specialMetricLicense_l,"|");
}
else
{
sbappend(sb,docNum,"~specialMetricLicense_l~","","|");
}
specialMetric_l=jsonpathgetsingle(jsonData,"$.specialMetric_l");
if(specialMetric_l<>"" AND NOT isnull(specialMetric_l) AND specialMetric_l<>" ")
{
sbappend(sb,docNum,"~specialMetric_l~",specialMetric_l,"|");
}
else
{
sbappend(sb,docNum,"~specialMetric_l~","","|");
}
usageQuantity_l=jsonpathgetsingle(jsonData,"$.usageQuantity_l");
if(usageQuantity_l<>"" AND NOT isnull(usageQuantity_l) AND usageQuantity_l<>" ")
{
sbappend(sb,docNum,"~usageQuantity_l~",usageQuantity_l,"|");
}
else
{
sbappend(sb,docNum,"~usageQuantity_l~","0","|");
}
nonStandardExistingQty_l=jsonpathgetsingle(jsonData,"$.nonStandardExistingQty_l");
if(nonStandardExistingQty_l<>"" AND NOT isnull(nonStandardExistingQty_l) AND nonStandardExistingQty_l<>" ")
{
sbappend(sb,docNum,"~nonStandardExistingQty_l~",nonStandardExistingQty_l,"|");
}
else
{
sbappend(sb,docNum,"~nonStandardExistingQty_l~","0","|");
}
serviceRequired_l=jsonpathgetsingle(jsonData,"$.serviceRequired_l");
if(serviceRequired_l<>"" AND NOT isnull(serviceRequired_l) AND serviceRequired_l<>" ")
{
sbappend(sb,docNum,"~serviceRequired_l~",serviceRequired_l,"|");
}
else
{
sbappend(sb,docNum,"~serviceRequired_l~","","|");
}
uSDCurrency_l=jsonpathgetsingle(jsonData,"$.uSDCurrency_l");
if(uSDCurrency_l<>"" AND NOT isnull(uSDCurrency_l) AND uSDCurrency_l<>" ")
{
sbappend(sb,docNum,"~uSDCurrency_l~",uSDCurrency_l,"|");
}
else
{
sbappend(sb,docNum,"~uSDCurrency_l~","0","|");
}
contractedOrPriorDealValue_l=jsonpathgetsingle(jsonData,"$.contractedOrPriorDealValue_l");
if(contractedOrPriorDealValue_l<>"" AND NOT isnull(contractedOrPriorDealValue_l) AND contractedOrPriorDealValue_l<>" ")
{
sbappend(sb,docNum,"~contractedOrPriorDealValue_l~",contractedOrPriorDealValue_l,"|");
}
else
{
sbappend(sb,docNum,"~contractedOrPriorDealValue_l~","","|");
}
contractedOrPriorLicenseSubFee_l=jsonpathgetsingle(jsonData,"$.contractedOrPriorLicenseSubFee_l");
if(contractedOrPriorLicenseSubFee_l<>"" AND NOT isnull(contractedOrPriorLicenseSubFee_l) AND contractedOrPriorLicenseSubFee_l<>" ")
{
sbappend(sb,docNum,"~contractedOrPriorLicenseSubFee_l~",contractedOrPriorLicenseSubFee_l,"|");
}
else
{
sbappend(sb,docNum,"~contractedOrPriorLicenseSubFee_l~","0","|");
}
contractedOrPriorSupportFee_l=jsonpathgetsingle(jsonData,"$.contractedOrPriorSupportFee_l");
if(contractedOrPriorSupportFee_l<>"" AND NOT isnull(contractedOrPriorSupportFee_l) AND contractedOrPriorSupportFee_l<>" ")
{
sbappend(sb,docNum,"~contractedOrPriorSupportFee_l~",contractedOrPriorSupportFee_l,"|");
}
else
{
sbappend(sb,docNum,"~contractedOrPriorSupportFee_l~","0","|");
}
priceUpliftAnnualRenewalValue_l=jsonpathgetsingle(jsonData,"$.priceUpliftAnnualRenewalValue_l");
if(priceUpliftAnnualRenewalValue_l<>"" AND NOT isnull(priceUpliftAnnualRenewalValue_l) AND priceUpliftAnnualRenewalValue_l<>" ")
{
sbappend(sb,docNum,"~priceUpliftAnnualRenewalValue_l~",priceUpliftAnnualRenewalValue_l,"|");
}
else
{
sbappend(sb,docNum,"~priceUpliftAnnualRenewalValue_l~","0","|");
}
newAnnualRenewalValue_l=jsonpathgetsingle(jsonData,"$.newAnnualRenewalValue_l");
if(newAnnualRenewalValue_l<>"" AND NOT isnull(newAnnualRenewalValue_l) AND newAnnualRenewalValue_l<>" ")
{
sbappend(sb,docNum,"~newAnnualRenewalValue_l~",newAnnualRenewalValue_l,"|");
}
else
{
sbappend(sb,docNum,"~newAnnualRenewalValue_l~","0","|");
}
renewalRate_l=jsonpathgetsingle(jsonData,"$.renewalRate_l");
if(renewalRate_l<>"" AND NOT isnull(renewalRate_l) AND renewalRate_l<>" ")
{
sbappend(sb,docNum,"~renewalRate_l~",renewalRate_l,"|");
}
else
{
sbappend(sb,docNum,"~renewalRate_l~","0","|");
}
upgradeMaterial_l=jsonpathgetsingle(jsonData,"$.upgradeMaterial_l");
if(upgradeMaterial_l<>"" AND NOT isnull(upgradeMaterial_l) AND upgradeMaterial_l<>" ")
{
sbappend(sb,docNum,"~upgradeMaterial_l~",upgradeMaterial_l,"|");
}
else
{
sbappend(sb,docNum,"~upgradeMaterial_l~","","|");
}
rollToLine_l=jsonpathgetsingle(jsonData,"$.rollToLine_l");
if(rollToLine_l<>"" AND NOT isnull(rollToLine_l) AND rollToLine_l<>" ")
{
sbappend(sb,docNum,"~rollToLine_l~",rollToLine_l,"|");
}
else
{
sbappend(sb,docNum,"~rollToLine_l~","","|");
}
existingContractQty_l=jsonpathgetsingle(jsonData,"$.existingContractQty_l");
if(existingContractQty_l<>"" AND NOT isnull(existingContractQty_l) AND existingContractQty_l<>" ")
{
sbappend(sb,docNum,"~existingContractQty_l~",existingContractQty_l,"|");
}
else
{
sbappend(sb,docNum,"~existingContractQty_l~","0","|");
}
existingQuantity_l=jsonpathgetsingle(jsonData,"$.existingQuantity_l");
if(existingQuantity_l<>"" AND NOT isnull(existingQuantity_l) AND existingQuantity_l<>" ")
{
sbappend(sb,docNum,"~existingQuantity_l~",existingQuantity_l,"|");
}
else
{
sbappend(sb,docNum,"~existingQuantity_l~","0","|");
}
existingContractValue_l=jsonpathgetsingle(jsonData,"$.existingContractValue_l");
if(existingContractValue_l<>"" AND NOT isnull(existingContractValue_l) AND existingContractValue_l<>" ")
{
sbappend(sb,docNum,"~existingContractValue_l~",existingContractValue_l,"|");
}
else
{
sbappend(sb,docNum,"~existingContractValue_l~","0","|");
}
approvalFlag_l=jsonpathgetsingle(jsonData,"$.approvalFlag_l");
if(approvalFlag_l<>"" AND NOT isnull(approvalFlag_l) AND approvalFlag_l<>" ")
{
sbappend(sb,docNum,"~approvalFlag_l~",approvalFlag_l,"|");
}
else
{
sbappend(sb,docNum,"~approvalFlag_l~","false","|");
}
uplift_l=jsonpathgetsingle(jsonData,"$.uplift_l");
if(uplift_l<>"" AND NOT isnull(uplift_l) AND uplift_l<>" ")
{
sbappend(sb,docNum,"~uplift_l~",uplift_l,"|");
}
else
{
sbappend(sb,docNum,"~uplift_l~","0","|");
}
active_l=jsonpathgetsingle(jsonData,"$.active_l");
if(active_l<>"" AND NOT isnull(active_l) AND active_l<>" ")
{
sbappend(sb,docNum,"~active_l~",active_l,"|");
}
else
{
sbappend(sb,docNum,"~active_l~","","|");
}
OfDaysInTerm_l=jsonpathgetsingle(jsonData,"$.OfDaysInTerm_l");
if(OfDaysInTerm_l<>"" AND NOT isnull(OfDaysInTerm_l) AND OfDaysInTerm_l<>" ")
{
sbappend(sb,docNum,"~OfDaysInTerm_l~",OfDaysInTerm_l,"|");
}
else
{
sbappend(sb,docNum,"~OfDaysInTerm_l~","0","|");
}
serial_l=jsonpathgetsingle(jsonData,"$.serial_l");
if(serial_l<>"" AND NOT isnull(serial_l) AND serial_l<>" ")
{
sbappend(sb,docNum,"~serial_l~",serial_l,"|");
}
else
{
sbappend(sb,docNum,"~serial_l~","","|");
}
cPUModelSerial_l=jsonpathgetsingle(jsonData,"$.cPUModelSerial_l");
if(cPUModelSerial_l<>"" AND NOT isnull(cPUModelSerial_l) AND cPUModelSerial_l<>" ")
{
sbappend(sb,docNum,"~cPUModelSerial_l~",cPUModelSerial_l,"|");
}
else
{
sbappend(sb,docNum,"~cPUModelSerial_l~","","|");
}
mmsCompletionFlag_l=jsonpathgetsingle(jsonData,"$.mmsCompletionFlag_l");
if(mmsCompletionFlag_l<>"" AND NOT isnull(mmsCompletionFlag_l) AND mmsCompletionFlag_l<>" ")
{
sbappend(sb,docNum,"~mmsCompletionFlag_l~",mmsCompletionFlag_l,"|");
}
else
{
sbappend(sb,docNum,"~mmsCompletionFlag_l~","","|");
}
daysBeforeQuarterEnd_l=jsonpathgetsingle(jsonData,"$.daysBeforeQuarterEnd_l");
if(daysBeforeQuarterEnd_l<>"" AND NOT isnull(daysBeforeQuarterEnd_l) AND daysBeforeQuarterEnd_l<>" ")
{
sbappend(sb,docNum,"~daysBeforeQuarterEnd_l~",daysBeforeQuarterEnd_l,"|");
}
else
{
sbappend(sb,docNum,"~daysBeforeQuarterEnd_l~","0","|");
}
unlimited_l=jsonpathgetsingle(jsonData,"$.unlimited_l");
if(unlimited_l<>"" AND NOT isnull(unlimited_l) AND unlimited_l<>" ")
{
sbappend(sb,docNum,"~unlimited_l~",unlimited_l,"|");
}
else
{
sbappend(sb,docNum,"~unlimited_l~","false","|");
}
monthlyFeePerUnitUSD_l=jsonpathgetsingle(jsonData,"$.monthlyFeePerUnitUSD_l");
if(monthlyFeePerUnitUSD_l<>"" AND NOT isnull(monthlyFeePerUnitUSD_l) AND monthlyFeePerUnitUSD_l<>" ")
{
sbappend(sb,docNum,"~monthlyFeePerUnitUSD_l~",monthlyFeePerUnitUSD_l,"|");
}
else
{
sbappend(sb,docNum,"~monthlyFeePerUnitUSD_l~","0","|");
}
baseProduct_l=jsonpathgetsingle(jsonData,"$.baseProduct_l");
if(baseProduct_l<>"" AND NOT isnull(baseProduct_l) AND baseProduct_l<>" ")
{
sbappend(sb,docNum,"~baseProduct_l~",baseProduct_l,"|");
}
else
{
sbappend(sb,docNum,"~baseProduct_l~","","|");
}
flags_l=jsonpathgetsingle(jsonData,"$.flags_l");
if(flags_l<>"" AND NOT isnull(flags_l) AND flags_l<>" ")
{
sbappend(sb,docNum,"~flags_l~",flags_l,"|");
}
else
{
sbappend(sb,docNum,"~flags_l~","false","|");
}
priorContractLineItem_l=jsonpathgetsingle(jsonData,"$.priorContractLineItem_l");
if(priorContractLineItem_l<>"" AND NOT isnull(priorContractLineItem_l) AND priorContractLineItem_l<>" ")
{
sbappend(sb,docNum,"~priorContractLineItem_l~",priorContractLineItem_l,"|");
}
else
{
sbappend(sb,docNum,"~priorContractLineItem_l~","","|");
}
priorContractExpirationDate_l=jsonpathgetsingle(jsonData,"$.priorContractExpirationDate_l");
if(priorContractExpirationDate_l<>"" AND NOT isnull(priorContractExpirationDate_l) AND priorContractExpirationDate_l<>" ")
{
sbappend(sb,docNum,"~priorContractExpirationDate_l~",priorContractExpirationDate_l,"|");
}
else
{
sbappend(sb,docNum,"~priorContractExpirationDate_l~",BRCM_blankDate_t,"|");
}
priorContract=jsonpathgetsingle(jsonData,"$.priorContract");
if(priorContract<>"" AND NOT isnull(priorContract) AND priorContract<>" ")
{
sbappend(sb,docNum,"~priorContract~",priorContract,"|");
}
else
{
sbappend(sb,docNum,"~priorContract~","","|");
}
taxInvoiceComment_l=jsonpathgetsingle(jsonData,"$.taxInvoiceComment_l");
if(taxInvoiceComment_l<>"" AND NOT isnull(taxInvoiceComment_l) AND taxInvoiceComment_l<>" ")
{
sbappend(sb,docNum,"~taxInvoiceComment_l~",taxInvoiceComment_l,"|");
}
else
{
sbappend(sb,docNum,"~taxInvoiceComment_l~","","|");
}
isDiscountable_l=jsonpathgetsingle(jsonData,"$.isDiscountable_l");
if(isDiscountable_l<>"" AND NOT isnull(isDiscountable_l) AND isDiscountable_l<>" ")
{
sbappend(sb,docNum,"~isDiscountable_l~",isDiscountable_l,"|");
}
else
{
sbappend(sb,docNum,"~isDiscountable_l~","","|");
}
standardQuantity_l=jsonpathgetsingle(jsonData,"$.standardQuantity_l");
if(standardQuantity_l<>"" AND NOT isnull(standardQuantity_l) AND standardQuantity_l<>" ")
{
sbappend(sb,docNum,"~standardQuantity_l~",standardQuantity_l,"|");
}
else
{
sbappend(sb,docNum,"~standardQuantity_l~","0","|");
}
estAnnualizedBooking_l=jsonpathgetsingle(jsonData,"$.estAnnualizedBooking_l");
if(estAnnualizedBooking_l<>"" AND NOT isnull(estAnnualizedBooking_l) AND estAnnualizedBooking_l<>" ")
{
sbappend(sb,docNum,"~estAnnualizedBooking_l~",estAnnualizedBooking_l,"|");
}
else
{
sbappend(sb,docNum,"~estAnnualizedBooking_l~","0","|");
}
estQuarterlyRevenue_l=jsonpathgetsingle(jsonData,"$.estQuarterlyRevenue_l");
if(estQuarterlyRevenue_l<>"" AND NOT isnull(estQuarterlyRevenue_l) AND estQuarterlyRevenue_l<>" ")
{
sbappend(sb,docNum,"~estQuarterlyRevenue_l~",estQuarterlyRevenue_l,"|");
}
else
{
sbappend(sb,docNum,"~estQuarterlyRevenue_l~","0","|");
}
deviation_l=jsonpathgetsingle(jsonData,"$.deviation_l");
if(deviation_l<>"" AND NOT isnull(deviation_l) AND deviation_l<>" ")
{
sbappend(sb,docNum,"~deviation_l~",deviation_l,"|");
}
else
{
sbappend(sb,docNum,"~deviation_l~","","|");
}
deviationPercent_l=jsonpathgetsingle(jsonData,"$.deviationPercent_l");
if(deviationPercent_l<>"" AND NOT isnull(deviationPercent_l) AND deviationPercent_l<>" ")
{
sbappend(sb,docNum,"~deviationPercent_l~",deviationPercent_l,"|");
}
else
{
sbappend(sb,docNum,"~deviationPercent_l~","0","|");
}
capacityAllowed_l=jsonpathgetsingle(jsonData,"$.capacityAllowed_l");
if(capacityAllowed_l<>"" AND NOT isnull(capacityAllowed_l) AND capacityAllowed_l<>" ")
{
sbappend(sb,docNum,"~capacityAllowed_l~",capacityAllowed_l,"|");
}
else
{
sbappend(sb,docNum,"~capacityAllowed_l~","false","|");
}
newSalesAllowed_l=jsonpathgetsingle(jsonData,"$.newSalesAllowed_l");
if(newSalesAllowed_l<>"" AND NOT isnull(newSalesAllowed_l) AND newSalesAllowed_l<>" ")
{
sbappend(sb,docNum,"~newSalesAllowed_l~",newSalesAllowed_l,"|");
}
else
{
sbappend(sb,docNum,"~newSalesAllowed_l~","","|");
}
perUnitPerListPrice_l=jsonpathgetsingle(jsonData,"$.perUnitPerListPrice_l");
if(perUnitPerListPrice_l<>"" AND NOT isnull(perUnitPerListPrice_l) AND perUnitPerListPrice_l<>" ")
{
sbappend(sb,docNum,"~perUnitPerListPrice_l~",perUnitPerListPrice_l,"|");
}
else
{
sbappend(sb,docNum,"~perUnitPerListPrice_l~","0","|");
}
totalNewSupportTermDays_l=jsonpathgetsingle(jsonData,"$.totalNewSupportTermDays_l");
if(totalNewSupportTermDays_l<>"" AND NOT isnull(totalNewSupportTermDays_l) AND totalNewSupportTermDays_l<>" ")
{
sbappend(sb,docNum,"~totalNewSupportTermDays_l~",totalNewSupportTermDays_l,"|");
}
else
{
sbappend(sb,docNum,"~totalNewSupportTermDays_l~","0","|");
}
existingSupportStartDateString_l=jsonpathgetsingle(jsonData,"$.existingSupportStartDateString_l");
if(existingSupportStartDateString_l<>"" AND NOT isnull(existingSupportStartDateString_l) AND existingSupportStartDateString_l<>" ")
{
sbappend(sb,docNum,"~existingSupportStartDateString_l~",existingSupportStartDateString_l,"|");
}
else
{
sbappend(sb,docNum,"~existingSupportStartDateString_l~","","|");
}
existingSupportExpirationDateString_l=jsonpathgetsingle(jsonData,"$.existingSupportExpirationDateString_l");
if(existingSupportExpirationDateString_l<>"" AND NOT isnull(existingSupportExpirationDateString_l) AND existingSupportExpirationDateString_l<>" ")
{
sbappend(sb,docNum,"~existingSupportExpirationDateString_l~",existingSupportExpirationDateString_l,"|");
}
else
{
sbappend(sb,docNum,"~existingSupportExpirationDateString_l~","","|");
}
previousPrice_l=jsonpathgetsingle(jsonData,"$.previousPrice_l");
if(previousPrice_l<>"" AND NOT isnull(previousPrice_l) AND previousPrice_l<>" ")
{
sbappend(sb,docNum,"~previousPrice_l~",previousPrice_l,"|");
}
else
{
sbappend(sb,docNum,"~previousPrice_l~","0","|");
}
installedAtCustomerNumber_l=jsonpathgetsingle(jsonData,"$.installedAtCustomerNumber_l");
if(installedAtCustomerNumber_l<>"" AND NOT isnull(installedAtCustomerNumber_l) AND installedAtCustomerNumber_l<>" ")
{
sbappend(sb,docNum,"~installedAtCustomerNumber_l~",installedAtCustomerNumber_l,"|");
}
else
{
sbappend(sb,docNum,"~installedAtCustomerNumber_l~","","|");
}
siteID_l=jsonpathgetsingle(jsonData,"$.siteID_l");
if(siteID_l<>"" AND NOT isnull(siteID_l) AND siteID_l<>" ")
{
sbappend(sb,docNum,"~siteID_l~",siteID_l,"|");
}
else
{
sbappend(sb,docNum,"~siteID_l~","","|");
}
siteIDStreetAddress_l=jsonpathgetsingle(jsonData,"$.siteIDStreetAddress_l");
if(siteIDStreetAddress_l<>"" AND NOT isnull(siteIDStreetAddress_l) AND siteIDStreetAddress_l<>" ")
{
sbappend(sb,docNum,"~siteIDStreetAddress_l~",siteIDStreetAddress_l,"|");
}
else
{
sbappend(sb,docNum,"~siteIDStreetAddress_l~","","|");
}
siteIDCityStateZip_l=jsonpathgetsingle(jsonData,"$.siteIDCityStateZip_l");
if(siteIDCityStateZip_l<>"" AND NOT isnull(siteIDCityStateZip_l) AND siteIDCityStateZip_l<>" ")
{
sbappend(sb,docNum,"~siteIDCityStateZip_l~",siteIDCityStateZip_l,"|");
}
else
{
sbappend(sb,docNum,"~siteIDCityStateZip_l~","","|");
}
siteIDZip_l=jsonpathgetsingle(jsonData,"$.siteIDZip_l");
if(siteIDZip_l<>"" AND NOT isnull(siteIDZip_l) AND siteIDZip_l<>" ")
{
sbappend(sb,docNum,"~siteIDZip_l~",siteIDZip_l,"|");
}
else
{
sbappend(sb,docNum,"~siteIDZip_l~","","|");
}
siteIDCountry_l=jsonpathgetsingle(jsonData,"$.siteIDCountry_l");
if(siteIDCountry_l<>"" AND NOT isnull(siteIDCountry_l) AND siteIDCountry_l<>" ")
{
sbappend(sb,docNum,"~siteIDCountry_l~",siteIDCountry_l,"|");
}
else
{
sbappend(sb,docNum,"~siteIDCountry_l~","","|");
}
hiddenPrice_l=jsonpathgetsingle(jsonData,"$.hiddenPrice_l");
if(hiddenPrice_l<>"" AND NOT isnull(hiddenPrice_l) AND hiddenPrice_l<>" ")
{
sbappend(sb,docNum,"~hiddenPrice_l~",hiddenPrice_l,"|");
}
else
{
sbappend(sb,docNum,"~hiddenPrice_l~","0","|");
}
projectEstStartDate_l=jsonpathgetsingle(jsonData,"$.projectEstStartDate_l");
if(projectEstStartDate_l<>"" AND NOT isnull(projectEstStartDate_l) AND projectEstStartDate_l<>" ")
{
sbappend(sb,docNum,"~projectEstStartDate_l~",projectEstStartDate_l,"|");
}
else
{
sbappend(sb,docNum,"~projectEstStartDate_l~",BRCM_blankDate_t,"|");
}
projectEstEndDate_l=jsonpathgetsingle(jsonData,"$.projectEstEndDate_l");
if(projectEstEndDate_l<>"" AND NOT isnull(projectEstEndDate_l) AND projectEstEndDate_l<>" ")
{
sbappend(sb,docNum,"~projectEstEndDate_l~",projectEstEndDate_l,"|");
}
else
{
sbappend(sb,docNum,"~projectEstEndDate_l~",BRCM_blankDate_t,"|");
}
serviceOffering_l=jsonpathgetsingle(jsonData,"$.serviceOffering_l");
if(serviceOffering_l<>"" AND NOT isnull(serviceOffering_l) AND serviceOffering_l<>" ")
{
sbappend(sb,docNum,"~serviceOffering_l~",serviceOffering_l,"|");
}
else
{
sbappend(sb,docNum,"~serviceOffering_l~","","|");
}
costCenter_l=jsonpathgetsingle(jsonData,"$.costCenter_l");
if(costCenter_l<>"" AND NOT isnull(costCenter_l) AND costCenter_l<>" ")
{
sbappend(sb,docNum,"~costCenter_l~",costCenter_l,"|");
}
else
{
sbappend(sb,docNum,"~costCenter_l~","","|");
}
chargeCode_l=jsonpathgetsingle(jsonData,"$.chargeCode_l");
if(chargeCode_l<>"" AND NOT isnull(chargeCode_l) AND chargeCode_l<>" ")
{
sbappend(sb,docNum,"~chargeCode_l~",chargeCode_l,"|");
}
else
{
sbappend(sb,docNum,"~chargeCode_l~","","|");
}
expenseAmountIncluded_l=jsonpathgetsingle(jsonData,"$.expenseAmountIncluded_l");
if(expenseAmountIncluded_l<>"" AND NOT isnull(expenseAmountIncluded_l) AND expenseAmountIncluded_l<>" ")
{
sbappend(sb,docNum,"~expenseAmountIncluded_l~",expenseAmountIncluded_l,"|");
}
else
{
sbappend(sb,docNum,"~expenseAmountIncluded_l~","0","|");
}
changeHoursunits_l=jsonpathgetsingle(jsonData,"$.changeHoursunits_l");
if(changeHoursunits_l<>"" AND NOT isnull(changeHoursunits_l) AND changeHoursunits_l<>" ")
{
sbappend(sb,docNum,"~changeHoursunits_l~",changeHoursunits_l,"|");
}
else
{
sbappend(sb,docNum,"~changeHoursunits_l~","0","|");
}
businessUnit_l=jsonpathgetsingle(jsonData,"$.businessUnit_l");
if(businessUnit_l<>"" AND NOT isnull(businessUnit_l) AND businessUnit_l<>" ")
{
sbappend(sb,docNum,"~businessUnit_l~",businessUnit_l,"|");
}
else
{
sbappend(sb,docNum,"~businessUnit_l~","","|");
}
totalChangeAmount_l=jsonpathgetsingle(jsonData,"$.totalChangeAmount_l");
if(totalChangeAmount_l<>"" AND NOT isnull(totalChangeAmount_l) AND totalChangeAmount_l<>" ")
{
sbappend(sb,docNum,"~totalChangeAmount_l~",totalChangeAmount_l,"|");
}
else
{
sbappend(sb,docNum,"~totalChangeAmount_l~","0","|");
}
projectDescription_l=jsonpathgetsingle(jsonData,"$.projectDescription_l");
if(projectDescription_l<>"" AND NOT isnull(projectDescription_l) AND projectDescription_l<>" ")
{
sbappend(sb,docNum,"~projectDescription_l~",projectDescription_l,"|");
}
else
{
sbappend(sb,docNum,"~projectDescription_l~","","|");
}
projectGroup_l=jsonpathgetsingle(jsonData,"$.projectGroup_l");
if(projectGroup_l<>"" AND NOT isnull(projectGroup_l) AND projectGroup_l<>" ")
{
sbappend(sb,docNum,"~projectGroup_l~",projectGroup_l,"|");
}
else
{
sbappend(sb,docNum,"~projectGroup_l~","","|");
}
approver_l=jsonpathgetsingle(jsonData,"$.approver_l");
if(approver_l<>"" AND NOT isnull(approver_l) AND approver_l<>" ")
{
sbappend(sb,docNum,"~approver_l~",approver_l,"|");
}
else
{
sbappend(sb,docNum,"~approver_l~","","|");
}
eOSDate_l=jsonpathgetsingle(jsonData,"$.eOSDate_l");
if(eOSDate_l<>"" AND NOT isnull(eOSDate_l) AND eOSDate_l<>" ")
{
sbappend(sb,docNum,"~eOSDate_l~",eOSDate_l,"|");
}
else
{
sbappend(sb,docNum,"~eOSDate_l~",BRCM_blankDate_t,"|");
}
existingSupportStartDate_l=jsonpathgetsingle(jsonData,"$.existingSupportStartDate_l");
if(existingSupportStartDate_l<>"" AND NOT isnull(existingSupportStartDate_l) AND existingSupportStartDate_l<>" ")
{
sbappend(sb,docNum,"~existingSupportStartDate_l~",existingSupportStartDate_l,"|");
}
else
{
sbappend(sb,docNum,"~existingSupportStartDate_l~",BRCM_blankDate_t,"|");
}
existingSupportExpirationDate_l=jsonpathgetsingle(jsonData,"$.existingSupportExpirationDate_l");
if(existingSupportExpirationDate_l<>"" AND NOT isnull(existingSupportExpirationDate_l) AND existingSupportExpirationDate_l<>" ")
{
sbappend(sb,docNum,"~existingSupportExpirationDate_l~",existingSupportExpirationDate_l,"|");
}
else
{
sbappend(sb,docNum,"~existingSupportExpirationDate_l~",BRCM_blankDate_t,"|");
}
monthlyFeePerUnitUSD_l=jsonpathgetsingle(jsonData,"$.monthlyFeePerUnitUSD_l");
if(monthlyFeePerUnitUSD_l<>"" AND NOT isnull(monthlyFeePerUnitUSD_l) AND monthlyFeePerUnitUSD_l<>" ")
{
sbappend(sb,docNum,"~monthlyFeePerUnitUSD_l~",monthlyFeePerUnitUSD_l,"|");
}
else
{
sbappend(sb,docNum,"~monthlyFeePerUnitUSD_l~","0","|");
}
expiringAnnualRenewal_l=jsonpathgetsingle(jsonData,"$.expiringAnnualRenewal_l");
if(expiringAnnualRenewal_l<>"" AND NOT isnull(expiringAnnualRenewal_l) AND expiringAnnualRenewal_l<>" ")
{
sbappend(sb,docNum,"~expiringAnnualRenewal_l~",expiringAnnualRenewal_l,"|");
}
else
{
sbappend(sb,docNum,"~expiringAnnualRenewal_l~","0","|");
}
marginPercent_l=jsonpathgetsingle(jsonData,"$.marginPercent_l");
if(marginPercent_l<>"" AND NOT isnull(marginPercent_l) AND marginPercent_l<>" ")
{
sbappend(sb,docNum,"~marginPercent_l~",marginPercent_l,"|");
}
else
{
sbappend(sb,docNum,"~marginPercent_l~","0","|");
}
requestedDiscount_l=jsonpathgetsingle(jsonData,"$.requestedDiscount_l");
if(requestedDiscount_l<>"" AND NOT isnull(requestedDiscount_l) AND requestedDiscount_l<>" ")
{
sbappend(sb,docNum,"~requestedDiscount_l~",requestedDiscount_l,"|");
}
else
{
sbappend(sb,docNum,"~requestedDiscount_l~","0","|");
}
createdBy_l=jsonpathgetsingle(jsonData,"$.createdBy_l");
if(createdBy_l<>"" AND NOT isnull(createdBy_l) AND createdBy_l<>" ")
{
sbappend(sb,docNum,"~createdBy_l~",createdBy_l,"|");
}
else
{
sbappend(sb,docNum,"~createdBy_l~","","|");
}
renewalsImportPricing=jsonpathgetsingle(jsonData,"$.renewalsImportPricing");
if(renewalsImportPricing<>"" AND NOT isnull(renewalsImportPricing) AND renewalsImportPricing<>" ")
{
sbappend(sb,docNum,"~renewalsImportPricing~",renewalsImportPricing,"|");
}
else
{
sbappend(sb,docNum,"~renewalsImportPricing~","","|");
}
renewalCreatedBy_l=jsonpathgetsingle(jsonData,"$.renewalCreatedBy_l");
if(renewalCreatedBy_l<>"" AND NOT isnull(renewalCreatedBy_l) AND renewalCreatedBy_l<>" ")
{
sbappend(sb,docNum,"~renewalCreatedBy_l~",renewalCreatedBy_l,"|");
}
else
{
sbappend(sb,docNum,"~renewalCreatedBy_l~","","|");
}
supportSiteID_l=jsonpathgetsingle(jsonData,"$.supportSiteID_l");
//Replacing tag Supportprovider_l with supportSiteID_l for SYMINT-6695 by Arjun 26-Mar-20

if(supportSiteID_l<>"" AND NOT isnull(supportSiteID_l) AND supportSiteID_l<>" ")
{
sbappend(sb,docNum,"~supportSiteID_l~",supportSiteID_l,"|");
}
else
{
sbappend(sb,docNum,"~supportSiteID_l~","","|");
}
itemInstanceID=jsonpathgetsingle(jsonData,"$.itemInstanceId_l");
if(itemInstanceID<>"" AND NOT isnull(itemInstanceID) AND itemInstanceID<>" ")
{
sbappend(sb,docNum,"~itemInstanceId_l~",itemInstanceID,"|");
}
else
{
sbappend(sb,docNum,"~itemInstanceId_l~","","|");
}




dropProductVal=jsonpathgetsingle(jsonData,"$.dropProduct_l");
if(dropProductVal=="true"){
 dropReasonVal=jsonpathgetsingle(jsonData,"$.dropReason_l");
}
else{
 sbappend(sb,docNum,"~dropReason_l~","","|");
}

if(dropProductVal<>"" AND NOT isnull(dropProductVal) AND dropProductVal<>" " and dropProductVal=="true")
{
 sbappend(sb,docNUm,"~dropReason_l~",dropReasonVal,"|");                 
 sbappend(sb,docNUm,"~dropProduct_l~",dropProductVal,"|");                 
 }
 else{
  sbappend(sb,docNum,"~dropReason_l~","","|");
  sbappend(sb,docNum,"~dropProduct_l~","false","|");
 }

 
  }
 }
}
 
return sbtostring(sb);