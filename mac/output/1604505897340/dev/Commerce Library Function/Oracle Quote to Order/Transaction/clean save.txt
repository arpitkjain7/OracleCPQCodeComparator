/*********************************************************************
        Function Name: Clean Save 
              Description: This library function is used to call updateTransaction for cleanSave action
              Author: Shruti
              User Story #: UID- 101
              Date: 1st march 2019
******************************Change Log*****************************
 Shivendra- Part of Enhancement BROCAD2-4933. Modified to fetch username,password,template location and url to hit for webservice call.
// added by shruti on 14th april 2020 to resolve 20A upgrade issue

*********************************************************************/

value = "";

//code for calling update transaction for soap v2
dictUpdate= dict("string");
userName = "";
pwd = "";
url = "";

//fetching the username, password, template location and url to from INT_SYSTEM_DETAILS table
fileLocation ="";
put(dictUpdate,"bs_Id",bs_id);
put(dictUpdate,"companyName",_system_company_name);
 resultSet = bmql("SELECT Username,Password,File_Location,SoapEndpoint FROM INT_SYSTEM_DETAILS WHERE System='CLEAN_SAVE'");
 for vals in resultSet{
 userName = get(vals,"Username");
  pwd = get(vals,"Password");
  fileLocation = get(vals,"File_Location");
  url = get(vals,"SoapEndpoint");
 }
// pass values in dictionary 
put(dictUpdate,"companyName",_system_company_name);
put(dictUpdate,"userName",userName);
put(dictUpdate,"pwd",pwd);
put(dictUpdate,"forLoop",data);

//apply template from fetching the xml from file manager

retVal = applytemplate(fileLocation,dictUpdate,"Not_Found");
// added by shruti on 14th april 2020 to resolve 20A upgrade issue
retVal = replace(retVal,"&#x3D;","=");
retVal = replace(retVal,"&lt;","<");
retVal = replace(retVal,"&gt;",">");
retVal = replace(retVal,"&quot;","\"");


// post data in the webservice
retVal1 = urldatabypost(url,retVal,"ERROR");


return value;