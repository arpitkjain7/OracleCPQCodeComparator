/*************************************************************************************************
Function Name : Line level Approval
Author : Nandhini Vurimella
Description : For the approval of each line level item.
*************************************************************************************************/
result = "";
flag = true;
levelup = 0;
for line in transactionLine{
approver = "";
workflow = "";
if(line._part_number <> ""){
part = line._part_number;
if(line.proposedNetUnitPriceRequested_l > line.salesMin1_l)
 {
  workflow = "approved";
 }
else { if( line.proposedNetUnitPriceRequested_l <= line.salesMin1_l and line.proposedNetUnitPriceRequested_l > line.salesMin2_l)
 {
  resultSet = bmql("select Sales_Manager from Approver_Parts where Part_Number = $part ");
  for rec in resultSet 
  {
   approver = get(rec,"Sales_Manager");
  }
  flag = false;
 }
else
 {
  resultSet = bmql("select Sales_Director from Approver_Parts where Part_Number = $part ");
  for rec in resultSet 
  {
   approver = get(rec,"Sales_Director");
  }
  flag = false;
 }
 }
 result = result + line._document_number + "~approver_l~" + approver + "|";
 result = result + line._document_number + "~workflowStatus_l~" + workflow + "|";
}
}
if (flag)
{
 levelup = levelup + 1;
 for line in transactionLine{
 approver = "";
 workflow = "";
 if(line._part_number <> ""){
  part = line._part_number;
  resultSet = bmql("select PL_Approver from Approver_Parts where Part_Number = $part ");
  for rec in resultSet 
  {
   approver = get(rec,"Sales_Director");
  }
   result = result + line._document_number + "~approver_l~" + approver + "|";
 result = result + line._document_number + "~workflowStatus_l~" + workflow + "|";
 }
 }
}
return result + "1~approvalLevelCompleted_avg~" + String(levelup) + "|";